<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance Sheet of May-2024</title>

    <link rel="stylesheet" href="./data table/css/bootstrap.min.css">
    <link rel="stylesheet" href="./data table/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.8.0/dist/full.min.css" rel="stylesheet" type="text/css" />
    <link rel="icon" href="./img/logo.jpg">
</head>

<body>

    <div class="container my-3">
        <div class="row mb-3">
            <div class="col-md-4">
                <select id="month-select" class="form-select">
                    <option value="2024-01">January 2024</option>
                    <option value="2024-02">February 2024</option>
                    <option value="2024-03">March 2024</option>
                    <option value="2024-04">April 2024</option>
                    <option value="2024-05"selected>May 2024</option>
                    <option value="2024-06">June 2024</option>
                    <option value="2024-07">July 2024</option>
                    <option value="2024-08">August 2024</option>
                    <option value="2024-09">September 2024</option>
                    <option value="2024-10">October 2024</option>
                    <option value="2024-11">November 2024</option>
                    <option value="2024-12">December 2024</option>
                </select>
            </div>
            <div class="col-md-2">
                <button id="update-month" class="btn btn-primary">Update Month</button>
            </div>
            <div class="col-md-2">
                <button id="download-pdf" class="btn btn-success">Download PDF</button>
            </div>
        </div>
        <div class="border-warning-subtle grid grid-flow-row-dense rounded-3xl">
            <div class="row">
                <div class="col">
                    <div class="data_table">
                        <table id="example" class="table-hover table">
                            <thead class="table-dark">
                                <!-- Headers will be dynamically generated -->
                            </thead>
                            <tbody>
                                <!-- Data will be dynamically generated -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="./data table/js/bootsrap.bundle.min.js"></script>
    <script src="./data table/js/jquery-3.6.0.min.js"></script>
    <script src="./data table/js/datatables.min.js"></script>
    <script src="./data table/js/pdfmake.min.js"></script>
    <script src="./data table/js/vfs_fonts.js"></script>
    <script src="./data table/js/custom.js"></script>
    <script src="./index.js"></script>
    <script src="./script.js"></script>

    <script>
        // Function to get the number of days in a month
        function getDaysInMonth(year, month) {
            return new Date(year, month, 0).getDate();
        }

        // Function to get the name of the day
        function getDayName(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { weekday: 'short' });
        }

        // Function to update the table based on the selected month
        function updateTable(year, month) {
            const daysInMonth = getDaysInMonth(year, month);
            const startDate = new Date(year, month - 1, 1);

            // Create header rows
            let headerHTML = `
                <tr class="text-capitalize">
                    <th colspan="4" class="text-center text-bg-Info fw-bolder text-lg"></th>
                    <th colspan="${daysInMonth}" class="text-center text-bg-Info fw-bolder text-lg"><h5>${new Date(year, month - 1).toLocaleString('default', { month: 'long' })} ${year}</h5></th>
                </tr>
                <tr class="text-capitalize">
                    <th class="text-bg-Info fw-bolder col-auto text-center text-lg"><h5>S.N</h5></th>
                    <th class="text-bg-Info fw-bolder text-center col-auto text-lg"><h5>Employee ID No.</h5></th>
                    <th class="text-bg-success fw-bolder text-center col-4 text-lg"><h5>Employees Name</h5></th>
                    <th class="text-bg-Info fw-bolder text-center col-4 text-lg"><h5>Job Title</h5></th>
                    ${Array.from({ length: daysInMonth }, (_, i) => {
                        const day = i + 1;
                        const dateStr = `${year}-${month}-${day}`;
                        return `<th class="text-bg-Info fw-bolder text-center text-lg"><h5>${getDayName(dateStr)}, ${day}</h5></th>`;
                    }).join('')}
                    <th class="text-bg-Info fw-bolder text-center text-lg"><h5>Total</h5></th>
                </tr>
            `;

            // Employees data here
            const employees = [
                { id: '1111825723', name: 'Abdulhakim Alammar', jobTitle: 'Project Manager' },
                { id: '2254394725', name: 'Shoeib Abou Zeid Mahmoud Awad', jobTitle: 'Operation Manager' },
                { id: '1063800229', name: 'Eman  Alnasser', jobTitle: 'Help Desk' },
                { id: '1008147140', name: 'Zahara', jobTitle: 'Help Desk' },
                { id: '1002929196', name: 'Saud Abdulaziz Albagawi', jobTitle: 'Chief Section Head' },
                { id: '1003490479', name: 'SALMAN DAWOOD MUBARAK', jobTitle: 'Bayer' },
                { id: '1004086458', name: 'Khalid Saud Alkhaldi', jobTitle: 'GRO office' },
                { id: '1009306679', name: 'SADIK SAIDUR MAHADI', jobTitle: 'Supervisor' },
                { id: '1010625711', name: 'Moneer Abdulhadi', jobTitle: 'HSE Supervisor' },
                { id: '1010686366', name: 'FAWAZ MUBARAK', jobTitle: 'Lead Gardner' },

                
                { id: '1012990964', name: 'Neezar Abdulrahim', jobTitle: 'Data Process Opertor' },
                { id: '1014293904', name: 'ADNAN ALAWI', jobTitle: 'Lead Gardner' },
                { id: '1028504395', name: 'Hussain Salleh', jobTitle: 'Equp opertor' },
                { id: '1028689220', name: 'Mozah Farss Aldossary', jobTitle: 'ForMan' },
                { id: '1030471211', name: 'ALI ABDUL HADI', jobTitle: 'Horticulturest' },
                { id: '1031410424', name: 'Ali Jaffar Alhaddad', jobTitle: 'Electrician' },
                { id: '1045951728', name: 'MUSTAFA DAWOOD MUBARAK', jobTitle: 'Equp opertor' },
                { id: '1050007960', name: 'YASSER ABDULHADI', jobTitle: 'Supervisor' },
                { id: '1059685774', name: 'Anwar Almubarak', jobTitle: 'Forman' },
                { id: '1059821973', name: 'Ahmed Dawood', jobTitle: 'Welder' },

                { id: '1060806096', name: 'SALMAN BIN ALI', jobTitle: 'Supervisor' },
                { id: '1074080902', name: 'Ali Bin Hussein', jobTitle: 'Supervisor' },
                { id: '1079836175', name: 'Hassan Ahmad AlZahrani', jobTitle: 'Material Expediter' },
                { id: '1085426169', name: 'Adnan Hussain', jobTitle: 'Mechanic' },
                { id: '1087109466', name: 'Ahmed Al-Dossary', jobTitle: 'Project Admin' },
                { id: '1087989883', name: 'Ibrahim Dawood Jassim Al Mubarak', jobTitle: 'Security' },
                { id: '1093276606', name: 'Hashem hussain Alshakuri', jobTitle: 'Forman Mechanic' },
                { id: '1097113474', name: 'Salim Zawayria', jobTitle: 'Forman Mechanic' },
                { id: '1102742648', name: 'Turki Yahya', jobTitle: 'GRO office' },
                { id: '1103136923', name: 'Ali Hassan ALMAHASNAH', jobTitle: 'Engineer' },


                { id: '1114777830', name: 'Mahadi Hassan', jobTitle: 'Supervisor' },
                { id: '1079836175', name: 'YAZAN ABU OBAYD', jobTitle: 'Supervisor' },
                { id: '2182413589', name: 'Mohd Amin Jinat', jobTitle: 'Forman' },
                { id: '2182500070', name: 'Billal W. Miah', jobTitle: 'Equp opertor' },
                { id: '2182562435', name: 'Ahsan Ulla Moksed Ali', jobTitle: 'Driver' },
                { id: '2194529679', name: 'Sinon Arrofo', jobTitle: 'Supervisor' },
                { id: '2195631219', name: 'Delower Hossain', jobTitle: 'Gardener' },
                { id: '2231024064', name: 'Shafiqul Islam Hazrat Ali', jobTitle: 'irrigation technician' },
                { id: '2234812275', name: 'Shadat Hossan', jobTitle: 'Driver' },
                { id: '2237074196', name: 'Shukur Mohd Ali', jobTitle: 'Labour' },
                // Add more employees as needed


                { id: '2237075912', name: 'Assauduzamman', jobTitle: 'Irrigation specialist' },
                { id: '2237076050', name: 'Mofiz Nayeb Ali', jobTitle: 'Forman' },
                { id: '2237342916', name: 'Lal Miah Messer', jobTitle: 'Forman' },
                { id: '2251498545', name: 'IMRAN SABJI FAROSH', jobTitle: 'Office Boy' },
                { id: '2253768424', name: 'BAKIR RIFAEY MOUSA AWAD', jobTitle: 'Lead Gardner' },
                { id: '2255145613', name: 'MOHAMMED MUSLIM', jobTitle: 'Pipe fitter' },
                { id: '2259560106', name: 'Robert morales', jobTitle: 'Supervisor' },
                { id: '2268090160', name: 'WASEEM CHHIMPA', jobTitle: 'Lab Chemist' },
                { id: '2268099096', name: 'Mohammad Luqman', jobTitle: 'pump operator' },
                { id: '2268207699', name: 'Arnulfo Lauron', jobTitle: 'Forman' },
                // Add more employees as needed

                { id: '2269348997', name: 'MOHAMMAD ARIF RAMZAN SARAW', jobTitle: 'Pipe fitter' },
                { id: '2270349554', name: 'Danilo Andrade Revilla', jobTitle: 'Supervisor' },
                { id: '2272775707', name: 'IMMAMUDDIN MOHD ABDUL GAFFAR', jobTitle: 'Cook' },
                { id: '2272779600', name: 'Julio Jr. Corpuz', jobTitle: 'pump operator' },
                { id: '2293975377', name: 'MOHD IMRAN GULL BAZ KHAN', jobTitle: 'Pipe fitter' },
                { id: '2312904465', name: 'ABDUL SALAM', jobTitle: 'Equp opertor' },
                { id: '2313446995', name: 'NAFEES AHMED MOHD', jobTitle: 'Pipe fitter' },
                { id: '2334029580', name: 'Javed Fateh', jobTitle: 'Document Controller' },
                { id: '2338250380', name: 'MOHAMMED ASLAM', jobTitle: 'Lead Gardner' },
                { id: '2345076778', name: 'Shahbaz Khan Banaras Khan', jobTitle: 'Secuerty' },
                // Add more employees as needed 60 done here


                // Add more employees as 61 Start here
                { id: '2345539411', name: 'Abdelgadir Mohammad', jobTitle: 'Supervisor' },
                { id: '2347102093', name: 'ANAS ELAMIN SALIH ALI', jobTitle: 'IT Admin' },
                { id: '2357582796', name: 'Anwar zeb murad ali', jobTitle: 'Store Helper' },
                { id: '2360318402', name: 'ABDULLAH TAHA', jobTitle: 'Accountant' },
                { id: '2362623007', name: 'Hassan Nawaz', jobTitle: 'Camp Boss' },
                { id: '2363702099', name: 'Sonam Pashang', jobTitle: 'Equp opertor' },
                { id: '2364018263', name: 'Saeed Ahmed Hkohar', jobTitle: 'Secuirty Gurad' },
                { id: '2364585261', name: 'Firuz Tarufder Md abdul Hamid', jobTitle: 'Equp opertor' },
                { id: '2381350079', name: 'Islam Ramzan Khan', jobTitle: 'Driver' },
                { id: '2381603584', name: 'ABDUL JABBAR', jobTitle: 'Supervisor' },
                // Add more employees as needed 70 done here


                // Add more employees as 71 Start here
                { id: '2381772371', name: 'Sahnawaz Alam', jobTitle: 'Forman' },
                { id: '2383739907', name: 'Muhammad Wasid Sayed', jobTitle: 'pump operator' },
                { id: '2387087774', name: 'UDDHAB PRASAD GIRI', jobTitle: 'Plumper' },
                { id: '2393912742', name: 'Antonio Enario', jobTitle: 'Floroculturest' },
                { id: '2396566198', name: 'Coyle Kay', jobTitle: 'Camp janitor' },
                { id: '2397587276', name: 'ZAKEER HUSSAIN FATEH MOHD', jobTitle: 'Equp opertor' },
                { id: '2409252893', name: 'MOHD SARIFUL ISLAM', jobTitle: 'Irrigation technician' },
                { id: '2414440285', name: 'Hilal Kamal', jobTitle: 'Forman' },
                { id: '2420562395', name: 'Ashraf Ahmed Abdulhadi', jobTitle: 'Project Planner' },
                { id: '2424962989', name: 'Bipad Mondal Madan', jobTitle: 'Lead Gardner' },
                // Add more employees as needed 80 done here

                // Add more employees as 81 Start here
                { id: '2428049825', name: 'MD JUWEL ISLAM', jobTitle: 'Labour' },
                { id: '2433995657', name: 'MOHD SABUJ', jobTitle: 'Labour' },
                { id: '2443400342', name: 'Sher Shah', jobTitle: 'HSE Supervisor' },
                { id: '2448555926', name: 'MD Asad', jobTitle: 'Electrician' },
                { id: '2453709376', name: 'Gobindo Fokir Chan', jobTitle: 'Lead Gardner' },
                { id: '2454342771', name: 'LOTIF MIAH AKRAB', jobTitle: 'Cook' },
                { id: '2454699634', name: 'MD Fhozlul Hakue', jobTitle: 'Asphalt Technician' },
                { id: '2454700887', name: 'Alam Mia', jobTitle: 'technician' },
                { id: '2457710008', name: 'Kamrul Islam', jobTitle: 'Forman' },
                { id: '2457711089', name: 'Mohammad Masum', jobTitle: 'Mechanic' },
                // Add more employees as needed 90 done here


                // Add more employees as 91 Start here
                { id: '2459481608', name: 'Nazrul Islam', jobTitle: 'Electrician' },
                { id: '2460096924', name: 'RASEEL MIAH ABDUL', jobTitle: 'Driver' },
                { id: '2465439194', name: 'ABUL KALAM AMINUDDIN', jobTitle: 'Gardener' },
                { id: '2470358843', name: 'Moustafa Kamel', jobTitle: 'Forman' },
                { id: '2476545252', name: 'MD Harrayed Mia', jobTitle: 'Labour' },
                { id: '2477933697', name: 'MD DALOWAR', jobTitle: 'Gardener' },
                { id: '2482796352', name: 'Masdur Rhaman', jobTitle: 'Gardener' },
                { id: '2483674780', name: 'MD ANISUR RHAMAN', jobTitle: 'Mechanic' },
                { id: '2483842916', name: 'Afrazier Nassal', jobTitle: 'QA/QC Engineer' },
                { id: '2484839572', name: 'MOHAMMAD ALAMIN MIAH MOHAMMED', jobTitle: 'Forman' },
                // Add more employees as needed 100 done here

                // Add more employees as 101 Start here
                { id: '2459481608', name: 'Nazrul Islam', jobTitle: 'Electrician' },
                { id: '2460096924', name: 'RASEEL MIAH ABDUL', jobTitle: 'Driver' },
                { id: '2465439194', name: 'ABUL KALAM AMINUDDIN', jobTitle: 'Gardener' },
                { id: '2470358843', name: 'Moustafa Kamel', jobTitle: 'Forman' },
                { id: '2476545252', name: 'MD Harrayed Mia', jobTitle: 'Labour' },
                { id: '2477933697', name: 'MD DALOWAR', jobTitle: 'Gardener' },
                { id: '2482796352', name: 'Masdur Rhaman', jobTitle: 'Gardener' },
                { id: '2483674780', name: 'MD ANISUR RHAMAN', jobTitle: 'Mechanic' },
                { id: '2483842916', name: 'Afrazier Nassal', jobTitle: 'QA/QC Engineer' },
                { id: '2484839572', name: 'MOHAMMAD ALAMIN MIAH MOHAMMED', jobTitle: 'Forman' },
                // Add more employees as needed 110 done here




                
            ];

            // Create body rows
            let bodyHTML = employees.map((employee, index) => `
                <tr>
                    <td>${index + 1}</td>
                    <td>${employee.id}</td>
                    <td>${employee.name}</td>
                    <td>${employee.jobTitle}</td>
                    ${Array.from({ length: daysInMonth }, (_, i) => {
                        const day = i + 1;
                        const dateStr = `${year}-${month}-${day}`;
                        const dayName = getDayName(dateStr);
                        if (dayName === 'Fri') {
                            return '<td contenteditable="true" style="background-color: yellow;">H</td>';
                        } else {
                            return '<td contenteditable="true">P</td>';
                        }
                    }).join('')}
                    <td contenteditable="true" class="total-cell"></td>
                </tr>
            `).join('');

            // Update table headers and body
            $('#example thead').html(headerHTML);
            $('#example tbody').html(bodyHTML);

            // Recalculate totals initially
            calculateTotals();
        }

        // Function to calculate total P and total H
        function calculateTotals() {
            $('#example tbody tr').each(function () {
                var totalP = 0;
                var totalH = 0;

                // Iterate through each cell in the row
                $(this).find('td').each(function (index) {
                    // Skip first four columns (S.N, Employee ID No., Employees Name, Job Title)
                    if (index > 3) {
                        var value = $(this).text().trim();
                        // Increment totalP if the cell contains 'P'
                        if (value === 'P') {
                            totalP++;
                        }
                        // Increment totalH if the cell contains 'H'
                        else if (value === 'H') {
                            totalH++;
                        }
                    }
                });

                // Update the total cell with the calculated values
                $(this).find('.total-cell').text(`P: ${totalP}, H: ${totalH}`);
            });
        }

        // Function to generate and download PDF
        function downloadPDF() {
            const [year, month] = $('#month-select').val().split('-');
            const daysInMonth = getDaysInMonth(year, month);
            const selectedMonthName = $('#month-select option:selected').text(); // Get the selected month name

            var docDefinition = {
                content: [
                    {
                        text: `Attendance Sheet for ${selectedMonthName}`, // Use the selected month name
                        style: 'header',
                        color: 'blue'  // Set header text color
                    },
                    {
                        table: {
                            headerRows: 2,
                            body: [
                                [
                                    { text: 'S.N', style: 'tableHeader', fillColor: '#D3D3D3' },
                                    { text: 'Employee ID No.', style: 'tableHeader', fillColor: '#D3D3D3' },
                                    { text: 'Employees Name', style: 'tableHeader', fillColor: '#D3D3D3' },
                                    { text: 'Job Title', style: 'tableHeader', fillColor: '#D3D3D3' },
                                    ...Array.from({ length: daysInMonth }, (_, i) => {
                                        const day = i + 1;
                                        const dateStr = `${$('#month-select').val()}-${day}`;
                                        return { text: `${getDayName(dateStr)}, ${day}`, style: 'tableHeader', fillColor: '#D3D3D3' };
                                    }),
                                    { text: 'Total', style: 'tableHeader', fillColor: '#D3D3D3' }
                                ],
                                ...$('#example tbody tr').map((index, tr) => {
                                    var $tr = $(tr);
                                    var row = [
                                        { text: $tr.find('td:eq(0)').text(), style: 'tableBody' },
                                        { text: $tr.find('td:eq(1)').text(), style: 'tableBody' },
                                        { text: $tr.find('td:eq(2)').text(), style: 'tableBody' },
                                        { text: $tr.find('td:eq(3)').text(), style: 'tableBody' },
                                        ...$tr.find('td:gt(3)').map((_, td) => ({ text: $(td).text(), style: 'tableBody' })).get()
                                    ];
                                    return row;
                                }).get()
                            ]
                        }
                    }
                ],
                styles: {
                    header: {
                        fontSize: 18,
                        bold: true,
                        margin: [0, 0, 0, 10]
                    },
                    tableHeader: {
                        bold: true,
                        fontSize: 13,
                        color: 'black'
                    },
                    tableBody: {
                        fontSize: 11
                    }
                }
            };

            pdfMake.createPdf(docDefinition).download(`Attendance_Sheet_${selectedMonthName}.pdf`); // Use the selected month name in the file name
        }

        // Event listener to update the month when the button is clicked
        $('#update-month').on('click', function () {
            const [year, month] = $('#month-select').val().split('-');
            updateTable(year, month);
        });

        // Event listener to recalculate totals whenever the table is updated
        $('#example tbody').on('input', 'td', function () {
            calculateTotals();
        });

        // Event listener to delete 'P' on double click
        $('#example tbody').on('dblclick', 'td', function () {
            if ($(this).text().trim() === 'P') {
                $(this).text('');
                calculateTotals();
            }
        });

        // Event listener to download PDF
        $('#download-pdf').on('click', function () {
            downloadPDF();
        });

        // Initialize the table with the default selected month
        const [defaultYear, defaultMonth] = $('#month-select').val().split('-');
        updateTable(defaultYear, defaultMonth);


    
    </script>

</body>

</html>
